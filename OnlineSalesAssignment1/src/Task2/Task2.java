package Task2;

import java.time.LocalDateTime;
import java.util.Collections;
import java.util.List;

public class Task2 {


    public static void main(String[] args) throws InterruptedException {

        // Example expressions
        List<String> expressionsLarge= List.of("2 * 4 * 4",
                "5 / (7 - 5)",
                "sqrt(5^2 - 4^2)",
                "sqrt(-3^2 - 4^2)",
                "3 + 8 - 2",
                "6 * (2 + 3)",
                "10 / (2 * 2)",
                "sqrt(9^2 + 12^2)",
                "7 - (4 + 2)",
                "2 * sqrt(16)",
                "(3 * 5) - 2",
                "15 / (3 + 2)",
                "sqrt(7^2 + 24^2)",
                "4 * (2 + 1)",
                "8 / (2 * 2)",
                "sqrt(12^2 - 9^2)",
                "5 - (3 + 1)",
                "3 * sqrt(25)",
                "9 / (3 + 1)",
                "sqrt(4^2 + 3^2)",
                "6 - (2 + 1)",
                "4 * sqrt(9)",
                "12 / (2 * 2)",
                "sqrt(16^2 - 12^2)",
                "8 - (5 + 1)",
                "3 * sqrt(36)",
                "14 / (2 + 1)",
                "sqrt(10^2 + 24^2)",
                "9 - (6 + 2)",
                "5 * sqrt(4)",
                "18 / (3 * 2)",
                "sqrt(25^2 - 15^2)",
                "7 - (4 + 2)",
                "4 * sqrt(16)",
                "16 / (2 * 2)",
                "sqrt(8^2 - 6^2)",
                "6 - (3 + 1)",
                "3 * sqrt(49)",
                "21 / (3 + 2)",
                "sqrt(11^2 + 60^2)",
                "8 + (4 * 2)",
                "2 * sqrt(20)",
                "10 / (2 * 2)",
                "sqrt(15^2 - 9^2)",
                "5 - (2 + 1)",
                "4 * sqrt(25)",
                "12 / (3 + 1)",
                "sqrt(7^2 + 24^2)",
                "9 - (5 + 2)",
                "3 * sqrt(16)",
                "14 / (2 + 1)",
                "sqrt(18^2 - 15^2)",
                "7 - (4 + 1)",
                "5 * sqrt(9)",
                "16 / (2 * 2)",
                "sqrt(10^2 - 6^2)",
                "6 - (3 + 2)",
                "3 * sqrt(36)",
                "21 / (3 * 2)",
                "sqrt(25^2 + 24^2)",
                "8 + (4 * 2)",
                "2 * sqrt(20)",
                "10 / (2 * 2)",
                "sqrt(15^2 - 9^2)",
                "5 - (2 + 1)",
                "4 * sqrt(25)",
                "12 / (3 + 1)",
                "sqrt(7^2 + 24^2)",
                "9 - (5 + 2)",
                "3 * sqrt(16)",
                "14 / (2 + 1)",
                "sqrt(18^2 - 15^2)",
                "7 - (4 + 1)",
                "5 * sqrt(9)",
                "16 / (2 * 2)",
                "sqrt(10^2 - 6^2)",
                "6 - (3 + 2)",
                "3 * sqrt(36)",
                "21 / (3 * 2)",
                "sqrt(25^2 + 24^2)",
                "2 * 4 * 4",
                "5 / (7 - 5)",
                "sqrt(5^2 - 4^2)",
                "sqrt(-3^2 - 4^2)",
                "3 + 8 - 2",
                "6 * (2 + 3)",
                "10 / (2 * 2)",
                "sqrt(9^2 + 12^2)",
                "7 - (4 + 2)",
                "2 * sqrt(16)",
                "(3 * 5) - 2",
                "15 / (3 + 2)",
                "sqrt(7^2 + 24^2)",
                "4 * (2 + 1)",
                "8 / (2 * 2)",
                "sqrt(12^2 - 9^2)",
                "5 - (3 + 1)",
                "3 * sqrt(25)",
                "9 / (3 + 1)",
                "sqrt(4^2 + 3^2)","2 * 4 * 4",
                "5 / (7 - 5)",
                "sqrt(5^2 - 4^2)",
                "sqrt(-3^2 - 4^2)",
                "3 + 8 - 2",
                "6 * (2 + 3)",
                "10 / (2 * 2)",
                "sqrt(9^2 + 12^2)",
                "7 - (4 + 2)",
                "2 * sqrt(16)",
                "(3 * 5) - 2",
                "15 / (3 + 2)",
                "sqrt(7^2 + 24^2)",
                "4 * (2 + 1)",
                "8 / (2 * 2)",
                "sqrt(12^2 - 9^2)",
                "5 - (3 + 1)",
                "3 * sqrt(25)",
                "9 / (3 + 1)",
                "sqrt(4^2 + 3^2)",
                "6 - (2 + 1)",
                "4 * sqrt(9)",
                "12 / (2 * 2)",
                "sqrt(16^2 - 12^2)",
                "8 - (5 + 1)",
                "3 * sqrt(36)",
                "14 / (2 + 1)",
                "sqrt(10^2 + 24^2)",
                "9 - (6 + 2)",
                "5 * sqrt(4)",
                "18 / (3 * 2)",
                "sqrt(25^2 - 15^2)",
                "7 - (4 + 2)",
                "4 * sqrt(16)",
                "16 / (2 * 2)",
                "sqrt(8^2 - 6^2)",
                "6 - (3 + 1)",
                "3 * sqrt(49)",
                "21 / (3 + 2)",
                "sqrt(11^2 + 60^2)",
                "8 + (4 * 2)",
                "2 * sqrt(20)",
                "10 / (2 * 2)",
                "sqrt(15^2 - 9^2)",
                "5 - (2 + 1)",
                "4 * sqrt(25)",
                "12 / (3 + 1)",
                "sqrt(7^2 + 24^2)",
                "9 - (5 + 2)",
                "3 * sqrt(16)",
                "14 / (2 + 1)",
                "sqrt(18^2 - 15^2)",
                "7 - (4 + 1)",
                "5 * sqrt(9)",
                "16 / (2 * 2)",
                "sqrt(10^2 - 6^2)",
                "6 - (3 + 2)",
                "3 * sqrt(36)",
                "21 / (3 * 2)",
                "sqrt(25^2 + 24^2)",
                "8 + (4 * 2)",
                "2 * sqrt(20)",
                "10 / (2 * 2)",
                "sqrt(15^2 - 9^2)",
                "5 - (2 + 1)",
                "4 * sqrt(25)",
                "12 / (3 + 1)",
                "sqrt(7^2 + 24^2)",
                "9 - (5 + 2)",
                "3 * sqrt(16)",
                "14 / (2 + 1)",
                "sqrt(18^2 - 15^2)",
                "7 - (4 + 1)",
                "5 * sqrt(9)",
                "16 / (2 * 2)",
                "sqrt(10^2 - 6^2)",
                "6 - (3 + 2)",
                "3 * sqrt(36)",
                "21 / (3 * 2)",
                "sqrt(25^2 + 24^2)",
                "2 * 4 * 4",
                "5 / (7 - 5)",
                "sqrt(5^2 - 4^2)",
                "sqrt(-3^2 - 4^2)",
                "3 + 8 - 2",
                "6 * (2 + 3)",
                "10 / (2 * 2)",
                "sqrt(9^2 + 12^2)",
                "7 - (4 + 2)",
                "2 * sqrt(16)",
                "(3 * 5) - 2",
                "15 / (3 + 2)",
                "sqrt(7^2 + 24^2)",
                "4 * (2 + 1)",
                "8 / (2 * 2)",
                "sqrt(12^2 - 9^2)",
                "5 - (3 + 1)",
                "3 * sqrt(25)",
                "9 / (3 + 1)",
                "sqrt(4^2 + 3^2)","2 * 4 * 4",
                "5 / (7 - 5)",
                "sqrt(5^2 - 4^2)",
                "sqrt(-3^2 - 4^2)",
                "3 + 8 - 2",
                "6 * (2 + 3)",
                "10 / (2 * 2)",
                "sqrt(9^2 + 12^2)",
                "7 - (4 + 2)",
                "2 * sqrt(16)",
                "(3 * 5) - 2",
                "15 / (3 + 2)",
                "sqrt(7^2 + 24^2)",
                "4 * (2 + 1)",
                "8 / (2 * 2)",
                "sqrt(12^2 - 9^2)",
                "5 - (3 + 1)",
                "3 * sqrt(25)",
                "9 / (3 + 1)",
                "sqrt(4^2 + 3^2)",
                "6 - (2 + 1)",
                "4 * sqrt(9)",
                "12 / (2 * 2)",
                "sqrt(16^2 - 12^2)",
                "8 - (5 + 1)",
                "3 * sqrt(36)",
                "14 / (2 + 1)",
                "sqrt(10^2 + 24^2)",
                "9 - (6 + 2)",
                "5 * sqrt(4)",
                "18 / (3 * 2)",
                "sqrt(25^2 - 15^2)",
                "7 - (4 + 2)",
                "4 * sqrt(16)",
                "16 / (2 * 2)",
                "sqrt(8^2 - 6^2)",
                "6 - (3 + 1)",
                "3 * sqrt(49)",
                "21 / (3 + 2)",
                "sqrt(11^2 + 60^2)",
                "8 + (4 * 2)",
                "2 * sqrt(20)",
                "10 / (2 * 2)",
                "sqrt(15^2 - 9^2)",
                "5 - (2 + 1)",
                "4 * sqrt(25)",
                "12 / (3 + 1)",
                "sqrt(7^2 + 24^2)",
                "9 - (5 + 2)",
                "3 * sqrt(16)",
                "14 / (2 + 1)",
                "sqrt(18^2 - 15^2)",
                "7 - (4 + 1)",
                "5 * sqrt(9)",
                "16 / (2 * 2)",
                "sqrt(10^2 - 6^2)",
                "6 - (3 + 2)",
                "3 * sqrt(36)",
                "21 / (3 * 2)",
                "sqrt(25^2 + 24^2)",
                "8 + (4 * 2)",
                "2 * sqrt(20)",
                "10 / (2 * 2)",
                "sqrt(15^2 - 9^2)",
                "5 - (2 + 1)",
                "4 * sqrt(25)",
                "12 / (3 + 1)",
                "sqrt(7^2 + 24^2)",
                "9 - (5 + 2)",
                "3 * sqrt(16)",
                "14 / (2 + 1)",
                "sqrt(18^2 - 15^2)",
                "7 - (4 + 1)",
                "5 * sqrt(9)",
                "16 / (2 * 2)",
                "sqrt(10^2 - 6^2)",
                "6 - (3 + 2)",
                "3 * sqrt(36)",
                "21 / (3 * 2)",
                "sqrt(25^2 + 24^2)",
                "2 * 4 * 4",
                "5 / (7 - 5)",
                "sqrt(5^2 - 4^2)",
                "sqrt(-3^2 - 4^2)",
                "3 + 8 - 2",
                "6 * (2 + 3)",
                "10 / (2 * 2)",
                "sqrt(9^2 + 12^2)",
                "7 - (4 + 2)",
                "2 * sqrt(16)",
                "(3 * 5) - 2",
                "15 / (3 + 2)",
                "sqrt(7^2 + 24^2)",
                "4 * (2 + 1)",
                "8 / (2 * 2)",
                "sqrt(12^2 - 9^2)",
                "5 - (3 + 1)",
                "3 * sqrt(25)",
                "9 / (3 + 1)",
                "sqrt(4^2 + 3^2)","2 * 4 * 4",
                "5 / (7 - 5)",
                "sqrt(5^2 - 4^2)",
                "sqrt(-3^2 - 4^2)",
                "3 + 8 - 2",
                "6 * (2 + 3)",
                "10 / (2 * 2)",
                "sqrt(9^2 + 12^2)",
                "7 - (4 + 2)",
                "2 * sqrt(16)",
                "(3 * 5) - 2",
                "15 / (3 + 2)",
                "sqrt(7^2 + 24^2)",
                "4 * (2 + 1)",
                "8 / (2 * 2)",
                "sqrt(12^2 - 9^2)",
                "5 - (3 + 1)",
                "3 * sqrt(25)",
                "9 / (3 + 1)",
                "sqrt(4^2 + 3^2)",
                "6 - (2 + 1)",
                "4 * sqrt(9)",
                "12 / (2 * 2)",
                "sqrt(16^2 - 12^2)",
                "8 - (5 + 1)",
                "3 * sqrt(36)",
                "14 / (2 + 1)",
                "sqrt(10^2 + 24^2)",
                "9 - (6 + 2)",
                "5 * sqrt(4)",
                "18 / (3 * 2)",
                "sqrt(25^2 - 15^2)",
                "7 - (4 + 2)",
                "4 * sqrt(16)",
                "16 / (2 * 2)",
                "sqrt(8^2 - 6^2)",
                "6 - (3 + 1)",
                "3 * sqrt(49)",
                "21 / (3 + 2)",
                "sqrt(11^2 + 60^2)",
                "8 + (4 * 2)",
                "2 * sqrt(20)",
                "10 / (2 * 2)",
                "sqrt(15^2 - 9^2)",
                "5 - (2 + 1)",
                "4 * sqrt(25)",
                "12 / (3 + 1)",
                "sqrt(7^2 + 24^2)",
                "9 - (5 + 2)",
                "3 * sqrt(16)",
                "14 / (2 + 1)",
                "sqrt(18^2 - 15^2)",
                "7 - (4 + 1)",
                "5 * sqrt(9)",
                "16 / (2 * 2)",
                "sqrt(10^2 - 6^2)",
                "6 - (3 + 2)",
                "3 * sqrt(36)",
                "21 / (3 * 2)",
                "sqrt(25^2 + 24^2)",
                "8 + (4 * 2)",
                "2 * sqrt(20)",
                "10 / (2 * 2)",
                "sqrt(15^2 - 9^2)",
                "5 - (2 + 1)",
                "4 * sqrt(25)",
                "12 / (3 + 1)",
                "sqrt(7^2 + 24^2)",
                "9 - (5 + 2)",
                "3 * sqrt(16)",
                "14 / (2 + 1)",
                "sqrt(18^2 - 15^2)",
                "7 - (4 + 1)",
                "5 * sqrt(9)",
                "16 / (2 * 2)",
                "sqrt(10^2 - 6^2)",
                "6 - (3 + 2)",
                "3 * sqrt(36)",
                "21 / (3 * 2)",
                "sqrt(25^2 + 24^2)",
                "2 * 4 * 4",
                "5 / (7 - 5)",
                "sqrt(5^2 - 4^2)",
                "sqrt(-3^2 - 4^2)",
                "3 + 8 - 2",
                "6 * (2 + 3)",
                "10 / (2 * 2)",
                "sqrt(9^2 + 12^2)",
                "7 - (4 + 2)",
                "2 * sqrt(16)",
                "(3 * 5) - 2",
                "15 / (3 + 2)",
                "sqrt(7^2 + 24^2)",
                "4 * (2 + 1)",
                "8 / (2 * 2)",
                "sqrt(12^2 - 9^2)",
                "5 - (3 + 1)",
                "3 * sqrt(25)",
                "9 / (3 + 1)",
                "sqrt(4^2 + 3^2)","2 * 4 * 4",
                "5 / (7 - 5)",
                "sqrt(5^2 - 4^2)",
                "sqrt(-3^2 - 4^2)",
                "3 + 8 - 2",
                "6 * (2 + 3)",
                "10 / (2 * 2)",
                "sqrt(9^2 + 12^2)",
                "7 - (4 + 2)",
                "2 * sqrt(16)",
                "(3 * 5) - 2",
                "15 / (3 + 2)",
                "sqrt(7^2 + 24^2)",
                "4 * (2 + 1)",
                "8 / (2 * 2)",
                "sqrt(12^2 - 9^2)",
                "5 - (3 + 1)",
                "3 * sqrt(25)",
                "9 / (3 + 1)",
                "sqrt(4^2 + 3^2)",
                "6 - (2 + 1)",
                "4 * sqrt(9)",
                "12 / (2 * 2)",
                "sqrt(16^2 - 12^2)",
                "8 - (5 + 1)",
                "3 * sqrt(36)",
                "14 / (2 + 1)",
                "sqrt(10^2 + 24^2)",
                "9 - (6 + 2)",
                "5 * sqrt(4)",
                "18 / (3 * 2)",
                "sqrt(25^2 - 15^2)",
                "7 - (4 + 2)",
                "4 * sqrt(16)",
                "16 / (2 * 2)",
                "sqrt(8^2 - 6^2)",
                "6 - (3 + 1)",
                "3 * sqrt(49)",
                "21 / (3 + 2)",
                "sqrt(11^2 + 60^2)",
                "8 + (4 * 2)",
                "2 * sqrt(20)",
                "10 / (2 * 2)",
                "sqrt(15^2 - 9^2)",
                "5 - (2 + 1)",
                "4 * sqrt(25)",
                "12 / (3 + 1)",
                "sqrt(7^2 + 24^2)",
                "9 - (5 + 2)",
                "3 * sqrt(16)",
                "14 / (2 + 1)",
                "sqrt(18^2 - 15^2)",
                "7 - (4 + 1)",
                "5 * sqrt(9)",
                "16 / (2 * 2)",
                "sqrt(10^2 - 6^2)",
                "6 - (3 + 2)",
                "3 * sqrt(36)",
                "21 / (3 * 2)",
                "sqrt(25^2 + 24^2)",
                "8 + (4 * 2)",
                "2 * sqrt(20)",
                "10 / (2 * 2)",
                "sqrt(15^2 - 9^2)",
                "5 - (2 + 1)",
                "4 * sqrt(25)",
                "12 / (3 + 1)",
                "sqrt(7^2 + 24^2)",
                "9 - (5 + 2)",
                "3 * sqrt(16)",
                "14 / (2 + 1)",
                "sqrt(18^2 - 15^2)",
                "7 - (4 + 1)",
                "5 * sqrt(9)",
                "16 / (2 * 2)",
                "sqrt(10^2 - 6^2)",
                "6 - (3 + 2)",
                "3 * sqrt(36)",
                "21 / (3 * 2)",
                "sqrt(25^2 + 24^2)",
                "2 * 4 * 4",
                "5 / (7 - 5)",
                "sqrt(5^2 - 4^2)",
                "sqrt(-3^2 - 4^2)",
                "3 + 8 - 2",
                "6 * (2 + 3)",
                "10 / (2 * 2)",
                "sqrt(9^2 + 12^2)",
                "7 - (4 + 2)",
                "2 * sqrt(16)",
                "(3 * 5) - 2",
                "15 / (3 + 2)",
                "sqrt(7^2 + 24^2)",
                "4 * (2 + 1)",
                "8 / (2 * 2)",
                "sqrt(12^2 - 9^2)",
                "5 - (3 + 1)",
                "3 * sqrt(25)",
                "9 / (3 + 1)",
                "sqrt(4^2 + 3^2)","2 * 4 * 4",
                "5 / (7 - 5)",
                "sqrt(5^2 - 4^2)",
                "sqrt(-3^2 - 4^2)",
                "3 + 8 - 2",
                "6 * (2 + 3)",
                "10 / (2 * 2)",
                "sqrt(9^2 + 12^2)",
                "7 - (4 + 2)",
                "2 * sqrt(16)",
                "(3 * 5) - 2",
                "15 / (3 + 2)",
                "sqrt(7^2 + 24^2)",
                "4 * (2 + 1)",
                "8 / (2 * 2)",
                "sqrt(12^2 - 9^2)",
                "5 - (3 + 1)",
                "3 * sqrt(25)",
                "9 / (3 + 1)",
                "sqrt(4^2 + 3^2)",
                "6 - (2 + 1)",
                "4 * sqrt(9)",
                "12 / (2 * 2)",
                "sqrt(16^2 - 12^2)",
                "8 - (5 + 1)",
                "3 * sqrt(36)",
                "14 / (2 + 1)",
                "sqrt(10^2 + 24^2)",
                "9 - (6 + 2)",
                "5 * sqrt(4)",
                "18 / (3 * 2)",
                "sqrt(25^2 - 15^2)",
                "7 - (4 + 2)",
                "4 * sqrt(16)",
                "16 / (2 * 2)",
                "sqrt(8^2 - 6^2)",
                "6 - (3 + 1)",
                "3 * sqrt(49)",
                "21 / (3 + 2)",
                "sqrt(11^2 + 60^2)",
                "8 + (4 * 2)",
                "2 * sqrt(20)",
                "10 / (2 * 2)",
                "sqrt(15^2 - 9^2)",
                "5 - (2 + 1)",
                "4 * sqrt(25)",
                "12 / (3 + 1)",
                "sqrt(7^2 + 24^2)",
                "9 - (5 + 2)",
                "3 * sqrt(16)",
                "14 / (2 + 1)",
                "sqrt(18^2 - 15^2)",
                "7 - (4 + 1)",
                "5 * sqrt(9)",
                "16 / (2 * 2)",
                "sqrt(10^2 - 6^2)",
                "6 - (3 + 2)",
                "3 * sqrt(36)",
                "21 / (3 * 2)",
                "sqrt(25^2 + 24^2)",
                "8 + (4 * 2)",
                "2 * sqrt(20)",
                "10 / (2 * 2)",
                "sqrt(15^2 - 9^2)",
                "5 - (2 + 1)",
                "4 * sqrt(25)",
                "12 / (3 + 1)",
                "sqrt(7^2 + 24^2)",
                "9 - (5 + 2)",
                "3 * sqrt(16)",
                "14 / (2 + 1)",
                "sqrt(18^2 - 15^2)",
                "7 - (4 + 1)",
                "5 * sqrt(9)",
                "16 / (2 * 2)",
                "sqrt(10^2 - 6^2)",
                "6 - (3 + 2)",
                "3 * sqrt(36)",
                "21 / (3 * 2)",
                "sqrt(25^2 + 24^2)",
                "2 * 4 * 4",
                "5 / (7 - 5)",
                "sqrt(5^2 - 4^2)",
                "sqrt(-3^2 - 4^2)",
                "3 + 8 - 2",
                "6 * (2 + 3)",
                "10 / (2 * 2)",
                "sqrt(9^2 + 12^2)",
                "7 - (4 + 2)",
                "2 * sqrt(16)",
                "(3 * 5) - 2",
                "15 / (3 + 2)",
                "sqrt(7^2 + 24^2)",
                "4 * (2 + 1)",
                "8 / (2 * 2)",
                "sqrt(12^2 - 9^2)",
                "5 - (3 + 1)",
                "3 * sqrt(25)",
                "9 / (3 + 1)",
                "sqrt(4^2 + 3^2)"
        );
        List<String> expressions1 = List.of(
                "sqrt(12^2 - 9^2)",
                "sqrt(7^2 + 24^2)",
                "4 * (2 + 1)",
                "8 / (2 * 2)",
                "sqrt(12^2 - 9^2)");

        // Example clients
        String clientId1 = "client1";
        String clientId2 = "client2";

        // Test Case 1: Adding expressions for multiple clients
        ExpressionEvaluator expressionEvaluator1 = new ExpressionEvaluator(50,"http://api.mathjs.org/v4/");

        expressionEvaluator1.addExpressions(expressionsLarge, clientId1);
        expressionEvaluator1.addExpressions(expressionsLarge, clientId2);

        expressionEvaluator1.shutdown();


        // Test Case 2: Add expressions for an empty list
        ExpressionEvaluator expressionEvaluator2 = new ExpressionEvaluator(25,"http://api.mathjs.org/v4/");
        List<String> emptyExpressions = Collections.emptyList();

        expressionEvaluator2.addExpressions(emptyExpressions, clientId1);
        expressionEvaluator2.shutdown();


        // Test Case 3: Add expressions exceeding the rate limit
        // we will test with 1000 client simultaneously trying to access at 5 request per second and 5 request per client
        System.out.println(LocalDateTime.now());
        ExpressionEvaluator expressionEvaluator3 = new ExpressionEvaluator(5,"http://api.mathjs.org/v4/");
        for (int i = 0; i < 1000; i++) {
            expressionEvaluator3.addExpressions(expressions1, ("client" + i));
        }

        expressionEvaluator3.shutdown();
        System.out.println(LocalDateTime.now());

        // Test Case 4: Shutdown immediately without adding expressions
        ExpressionEvaluator expressionEvaluator = new ExpressionEvaluator(25,"http://api.mathjs.org/v4/");
        expressionEvaluator.shutdown();



    }
}
